# Vulnerability Management Program Implementation

In this project, we simulate the implementation of a comprehensive vulnerability management program, from inception to completion.

_**Inception State:**_ the organization has no existing policy or vulnerability management practices in place.

_**Completion State:**_ a formal policy is enacted, stakeholder buy-in is secured, and a full cycle of organization-wide vulnerability remediation is successfully completed.

---

<img width="1000" alt="image" src="https://github.com/user-attachments/assets/cfc5dbcf-3fcb-4a71-9c13-2a49f8bab3e6">

# Technology Utilized
- Tenable (enterprise vulnerability management platform)
- Azure Virtual Machines (Nessus scan engine + scan targets)
- PowerShell & BASH (remediation scripts)

---


# Table of Contents

- [Vulnerability Management Policy Draft Creation](#vulnerability-management-policy-draft-creation)
- [Mock Meeting: Policy Buy-In (Stakeholders)](#step-2-mock-meeting-policy-buy-in-stakeholders)
- [Policy Finalization and Senior Leadership Sign-Off](#step-3-policy-finalization-and-senior-leadership-sign-off)
- [Mock Meeting: Initial Scan Permission (Server Team)](#step-4-mock-meeting-initial-scan-permission-server-team)
- [Initial Scan of Server Team Assets](#step-5-initial-scan-of-server-team-assets)
- [Vulnerability Assessment and Prioritization](#step-6-vulnerability-assessment-and-prioritization)
- [Distributing Remediations to Remediation Teams](#step-7-distributing-remediations-to-remediation-teams)
- [Mock Meeting: Post-Initial Discovery Scan (Server Team)](#step-8-mock-meeting-post-initial-discovery-scan-server-team)
- [Mock CAB Meeting: Implementing Remediations](#step-9-mock-cab-meeting-implementing-remediations)
- [Remediation Round 1: Outdated Wireshark Removal](#remediation-round-1-outdated-wireshark-removal)
- [Remediation Round 2: Insecure Protocols & Ciphers](#remediation-round-2-insecure-protocols--ciphers)
- [Remediation Round 3: Guest Account Group Membership](#remediation-round-3-guest-account-group-membership)
- [Remediation Round 4: Windows OS Updates](#remediation-round-4-windows-os-updates)
- [First Cycle Remediation Effort Summary](#first-cycle-remediation-effort-summary)

---

### Vulnerability Management Policy Draft Creation

This phase focuses on drafting a Vulnerability Management Policy as a starting point for stakeholder engagement. The initial draft outlines scope, responsibilities, and remediation timelines, and may be adjusted based on feedback from relevant departments to ensure practical implementation before final approval by upper management.  
[Draft Policy](https://docs.google.com/document/d/18pEe2vpFslPEncTYPG72r5rWU8OYlNDv3zMA1mwl9HE/edit?usp=sharing)

---

### Step 2) Mock Meeting: Policy Buy-In (Stakeholders)

In this phase, a meeting with the server team introduces the draft Vulnerability Management Policy and assesses their capability to meet remediation timelines. Feedback leads to adjustments, like extending the critical remediation window from 48 hours to one week, ensuring collaborative implementation.

## Policy Remediation Discussion

**Josh:** "Morning, Jimmy. How are things going? I know it's been busy."

**Jimmy:** "Good morning, Josh. It has been hectic, but we're managing. I've reviewed the policy draft. Overall, it's good, but with our current staffing, we can't meet the 48-hour window for critical vulnerabilities."

**Josh:** "I understand. That's aggressive. How about we extend the critical vulnerability remediation to one week initially? We can reserve the 48-hour window for true zero-day threats."

**Jimmy:** "That sounds reasonable. We'd also appreciate some leeway in the beginning, as we adjust to the new remediation and patching process, maybe for the first few months?"

**Josh:** "Absolutely. We're planning to give all departments six months to adjust after the policy is finalized. Does that work?"

**Jimmy:** "Yes, that's helpful. Thanks, Josh. We appreciate being included in the decision-making process."

**Josh:** "Of course, we're all in this together. Thanks for working with us."

**Jimmy:** "No problem. Thanks for the quick meeting."

**Josh:** "You're welcome. See you later."

**Jimmy:** "Bye."

---

### Step 3) Policy Finalization and Senior Leadership Sign-Off

After gathering feedback from the server team, the policy is revised, addressing aggressive remediation timelines. With final approval from upper management, the policy now guides the program, ensuring compliance and reference for pushback resolution.  
[Finalized Policy](https://docs.google.com/document/d/1R-UKAPmMuNZA28Jv5Vd-hi0kMEVQ2XHR59fH9lTuNno/edit?usp=sharing)

---

### Step 4) Mock Meeting: Initial Scan Permission (Server Team)

The team collaborates with the server team to initiate scheduled credential scans. A compromise is reached to scan a single server first, monitoring resource impact, and using just-in-time Active Directory credentials for secure, controlled access.  

## Vulnerability Scanning Setup

**Jimmy:** "Morning, Jimmy."

**Josh:** "Good morning! I heard you're ready to conduct some scans."

**Jimmy:** "Yep, now that our vulnerability management policy is in place, I wanted to start scheduled credential scans of your environment."

**Josh:** "Sounds good to me. What's involved, and how can we help?"

**Jimmy:** "We're planning weekly scans of the server infrastructure. We estimate it'll take 4-6 hours to scan all 200 assets. We'll need administrative credentials to allow the scan engine to remotely log in and assess the targets."

**Josh:** "Whoa, hold on. What does the scanning entail? I'm worried about resource utilization. Also, admin credentials to all 200 machines? That doesn't sound safe."

**Jimmy:** "Those are valid concerns. The scan engine sends traffic to the servers to check for vulnerabilities, like registry checks, outdated software, and insecure protocols. That's why credentials are required."

**Josh:** "I see. Well, as long as it doesn't bring the servers offline, I guess we're okay. But let's scan a single server first and monitor resource utilization."

**Jimmy:** "Not a bad idea. Great. Also, for the credentials, can you set up an Active Directory account? You can leave it disabled until we're ready to scan, then enable it during the scan, and disable it afterward. A just-in-time access situation."

**Josh:** "That sounds good. I'll ask Susan to start automating the account provisioning."

**Jimmy:** "Awesome. Okay, talk soon."

**Josh:** "Yeah, sounds good. I'll get back to you once the credentials are set up. See you later."

**Jimmy:** "See you later."

---

### Step 5) Initial Scan of Server Team Assets

In this phase, an insecure Windows Server is provisioned to simulate the server team's environment. After creating vulnerabilities, an authenticated scan is performed, and the results are exported for future remediation steps.  

![image](https://github.com/user-attachments/assets/4cade506-bb95-48fb-9053-016df9c8246c)


[Scan 1 - Initial Scan](https://drive.google.com/file/d/1ilXTqaFdmVPiJmsTL-VHhgqkc1gG4ZVa/view?usp=sharing)


---

### Step 6) Vulnerability Assessment and Prioritization

We assessed vulnerabilities and established a remediation prioritization strategy based on ease of remediation and impact. The following priorities were set:

1. Third Party Software Removal (Wireshark)
2. Windows OS Secure Configuration (Protocols & Ciphers)
3. Windows OS Secure Configuration (Guest Account Group Membership)
4. Windows OS Updates

---

### Step 7) Distributing Remediations to Remediation Teams

The server team received remediation scripts and scan reports to address key vulnerabilities. This streamlined their efforts and prepared them for a follow-up review.  

<img width="635" alt="image" src="https://github.com/user-attachments/assets/bbf9478f-e1d1-4898-846e-b510ec8c6f72">

[Remediation Email](https://github.com/Hasnake84/Tenable-Nessus-Metasploitable/blob/main/Remediation-Email.md)

---

### Step 8) Mock Meeting: Post-Initial Discovery Scan (Server Team)

The server team reviewed vulnerability scan results, identifying outdated software, insecure accounts, and deprecated protocols. The remediation packages were prepared for submission to the Change Control Board (CAB). 

## Vulnerability Scan Findings and Remediation

**Josh:** "Morning, Jimmy. How are you doing?"

**Jimmy:** "Not bad for a Monday. And yourself?"

**Josh:** "I'm still alive, so I can't complain. But before we get into the vulnerabilities, how did the actual scan go on your end? Any outages or over-utilization?"

**Jimmy:** "The scan went well. We were monitoring, and aside from the open connections, we wouldn't have known a scan was taking place."

**Josh:** "Yeah, that's good news. I expected as much. We'll keep monitoring, but I don't expect any resource issues. Do you mind if I dive into the vulnerability findings?"

**Jimmy:** "Yeah, absolutely."

**Josh:** "Cool. I'm sharing my screen. Basically, most vulnerabilities come from outdated Wireshark installations. One interesting find is that the local guest account on the servers belongs to the local administrators group. I'm not sure why. Some vulnerabilities, like the Microsoft Edge Chromium one, might be resolved by Windows updates. We can ignore the self-signed certificate warning. However, the medium-strength cipher suites and TLS 1.1/1.0 are deprecated and need remediation. So, we're looking at Wireshark, the guest account, and the deprecated protocols."

**Jimmy:** "Very interesting. The good news is, most of our servers likely have the same vulnerabilities, which should simplify remediation."

**Josh:** "Yeah, a uniform load-out. Do you foresee any issues remediating the cipher suites and insecure protocols?"

**Jimmy:** "I highly doubt it. We'll run it through the next Change Control Board. Uninstalling Wireshark and fixing the guest account shouldn't be an issue. I'll talk to our CIS admins about that."

**Josh:** "That's good news. I'll start building remediation packages to make your life easier."

**Jimmy:** "That sounds great. Oh, do you have patch management in place for Windows update vulnerabilities?"

**Josh:** "Yes, Windows updates should be handled automatically by next week."

**Jimmy:** "Excellent. All right, I'll research the best way to remediate these findings and get back to you before the next Change Control Board."

**Jimmy:** "Sounds good. Talk to you soon."

**Josh:** "Cool, talk to you soon."

---

### Step 9) Mock CAB Meeting: Implementing Remediations

The Change Control Board (CAB) reviewed and approved the plan to remove insecure protocols and cipher suites. The plan included a rollback script and a tiered deployment approach.  

## Change Control Board Meeting: Vulnerability Remediations

**Johnny (CAB Facilitator):** "Okay, next up on the list are a couple of vulnerability remediations for the server team: number one, removal of insecure protocols, and number two, removal of insecure cipher suites. It looks like Josh from the risk department is working in conjunction with Jimmy from infrastructure on this. Jimmy (Server Team Manager), do you want to walk us through the technical aspects of the change being implemented?"

**Jimmy (Server Team Manager):** "Normally I would, but do you mind giving this one to Josh (VM Sec. Analyst)? He actually built a solution for us, and we're still getting used to the process."

**Josh (VM Sec. Analyst):** "Uh, yeah, I can explain these. So, basically, insecure cipher suites and protocols... their existence on the system means the system is capable of negotiating and using algorithms or protocols that have been deprecated. If it connects to a server that only wants to use those protocols, it's possible the computer will use them. These are controlled by the Windows registry. It's a really simple fix. We wrote a PowerShell script that disables all the insecure protocols and ciphers and enables the ones that are standardized or today's standard, which are secure. So, it's really straightforward."

**Jack (Lead Sys Engr):** "Yeah, that sounds good, but what if something goes wrong? Do we have a rollback plan in place? Did you even think about that?"

**Josh (VM Sec. Analyst):** "Yes, absolutely. So, first of all, we have a tiered deployment. It means a pilot group, which is a really small group of computers, pre-pilot, pre-production, and then finally production, where it goes everywhere. On top of this, we have a fully built-in, automated rollback script for each remediation. The script will restore the original protocols and ciphers should there be any unknown issues that come up."

**Jack (Lead Sys Engr):** "That sounds good. I guess I notice the fixes are simple registry updates. I'm not too concerned, I suppose."

**Josh (VM Sec. Analyst):** "Yep, exactly."

**Johnny (CAB Facilitator):** "Any more questions from anybody? Great, that wraps things up for this week's CAB meeting. See you all next week."

**All:** "See you later."

---
### Step 10 ) Remediation Effort

#### Remediation Round 1: Outdated Wireshark Removal

The server team used a PowerShell script to remove outdated Wireshark. A follow-up scan confirmed successful remediation.  
[Wireshark Removal Script](https://github.com/joshmadakor1/lognpacific-public/blob/main/automation/remediation-wireshark-uninstall.ps1)  

![image](https://github.com/user-attachments/assets/9ce45503-fc59-4b6b-a3b7-3ad460045cda)


[Scan 2 - Third Party Software Removal](https://drive.google.com/file/d/1RWAkrDUrejtrzQdMhgSrIQusGbv-Ii7c/view?usp=sharing)


#### Remediation Round 2: Insecure Protocols & Ciphers

The server team used PowerShell scripts to remediate insecure protocols and cipher suites. A follow-up scan verified successful remediation, and the results were saved for reference.  
[PowerShell: Insecure Protocols Remediation](https://github.com/joshmadakor1/lognpacific-public/blob/main/automation/toggle-protocols.ps1)
[PowerShell: Insecure Ciphers Remediation](https://github.com/joshmadakor1/lognpacific-public/blob/main/automation/toggle-cipher-suites.ps1)

![image](https://github.com/user-attachments/assets/8cb42d93-f210-477b-8fdf-85deeb2257b7)


[Scan 3 - Ciphersuites and Protocols](https://drive.google.com/file/d/13gRy9zvrmeygf5aX0ARdxzx5QIUOJiUY/view?usp=sharing)


#### Remediation Round 3: Guest Account Group Membership

The server team removed the guest account from the administrator group. A new scan confirmed remediation, and the results were exported for comparison.  
[PowerShell: Guest Account Group Membership Remediation](https://github.com/joshmadakor1/lognpacific-public/blob/main/automation/toggle-guest-local-administrators.ps1)  

![image](https://github.com/user-attachments/assets/87253709-b69a-4761-97d6-0ccf4dcced55)


[Scan 4 - Guest Account Group Removal](https://drive.google.com/file/d/13gRy9zvrmeygf5aX0ARdxzx5QIUOJiUY/view?usp=drive_link)


#### Remediation Round 4: Windows OS Updates

Windows updates were re-enabled and applied until the system was fully up to date. A final scan verified the changes  

![image](https://github.com/user-attachments/assets/e3776b3d-b9c1-4e4a-94cd-c66db7da45eb)


[Scan 5 - Post Windows Updates](https://drive.google.com/file/d/1mjT5uEgqyw-0uFsJknBqSIunhkUN7jt_/view?usp=sharing)

---

### First Cycle Remediation Effort Summary

The remediation process reduced total vulnerabilities by 80%, from 29 to 4. Critical vulnerabilities were resolved by the second scan (100%), and high vulnerabilities dropped by 90%. Mediums were reduced by 76%. In an actual production environment, asset criticality would further guide future remediation efforts.  

![image](https://github.com/user-attachments/assets/e58fb08e-c17c-41c7-bb47-5f84306d72ce)


[Remediation Data](https://docs.google.com/spreadsheets/d/1zpeNbyErOpBs_VVW7RoPehPOGMOxhB50hxPhJ3RdxZw/edit?usp=sharing)

---

### On-going Vulnerability Management (Maintenance Mode)

After completing the initial remediation cycle, the vulnerability management program transitions into **Maintenance Mode**. This phase ensures that vulnerabilities continue to be managed proactively, keeping systems secure over time. Regular scans, continuous monitoring, and timely remediation are crucial components of this phase. (See [Finalized Policy](https://docs.google.com/document/d/1rvueLX_71pOR8ldN9zVW9r_zLzDQxVsnSUtNar8ftdg/edit?usp=drive_link) for scanning and remediation cadence requirements.)

Key activities in Maintenance Mode include:
- **Scheduled Vulnerability Scans**: Perform regular scans (e.g., weekly or monthly) to detect new vulnerabilities as systems evolve.
- **Patch Management**: Continuously apply security patches and updates, ensuring no critical vulnerabilities remain unpatched.
- **Remediation Follow-ups**: Address newly identified vulnerabilities promptly, prioritizing based on risk and impact.
- **Policy Review and Updates**: Periodically review the Vulnerability Management Policy to ensure it aligns with the latest security best practices and organizational needs.
- **Audit and Compliance**: Conduct internal audits to ensure compliance with the vulnerability management policy and external regulations.
- **Ongoing Communication with Stakeholders**: Maintain open communication with teams responsible for remediation, ensuring efficient coordination.

By maintaining an active vulnerability management process, organizations can stay ahead of emerging threats and ensure long-term security resilience.
